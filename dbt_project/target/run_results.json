{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.4", "generated_at": "2023-12-17T23:13:51.826810Z", "invocation_id": "9a12bc13-36f0-44dc-91fb-67d4e31d5c51", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-17T23:13:50.281888Z", "completed_at": "2023-12-17T23:13:50.301803Z"}, {"name": "execute", "started_at": "2023-12-17T23:13:50.304875Z", "completed_at": "2023-12-17T23:13:50.681364Z"}], "thread_id": "Thread-1", "execution_time": 0.41048169136047363, "adapter_response": {"_message": "SELECT 2208", "code": "SELECT", "rows_affected": 2208}, "message": "SELECT 2208", "failures": null, "unique_id": "model.dbt_project.staging_users", "compiled": true, "compiled_code": "SELECT\n    user_id::VARCHAR(255),\n    name -> 'first' AS first_name,\n    (name ->> 'last')::VARCHAR(255) AS last_name,\n    seed::VARCHAR(255) AS seed,\n    (dob ->> 'date')::VARCHAR(10) AS dob,\n    (dob ->> 'age')::INT AS age,\n    nat::VARCHAR(100) AS nationality,\n    gender::VARCHAR(5) AS gender,\n    (registered ->> 'date')::DATE as reg_date\nFROM \"warehouse\".\"raw\".\"users\"", "relation_name": "\"warehouse\".\"analytics\".\"staging_users\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-17T23:13:50.710177Z", "completed_at": "2023-12-17T23:13:50.718713Z"}, {"name": "execute", "started_at": "2023-12-17T23:13:50.721390Z", "completed_at": "2023-12-17T23:13:51.302377Z"}], "thread_id": "Thread-1", "execution_time": 0.6033196449279785, "adapter_response": {"_message": "SELECT 28964", "code": "SELECT", "rows_affected": 28964}, "message": "SELECT 28964", "failures": null, "unique_id": "model.dbt_project.dim_date", "compiled": true, "compiled_code": "SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS dim_date_id,\n       datum::date AS date,\n       TO_CHAR(datum, 'TMDay') AS day_name,\n       EXTRACT(ISODOW FROM datum) AS day_of_week,\n       EXTRACT(DAY FROM datum) AS day_of_month,\n       EXTRACT(DOY FROM datum) AS day_of_year,\n       TO_CHAR(datum, 'W')::INT AS week_of_month,\n       EXTRACT(WEEK FROM datum) AS week_of_year,\n       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '\"-W\"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,\n       EXTRACT(MONTH FROM datum) AS month_actual,\n       TO_CHAR(datum, 'TMMonth') AS month_name,\n       TO_CHAR(datum, 'Mon') AS month_name_abbreviated\nFROM (\n   select * \n      from \n      generate_series(\n         (select min(dob)::date from \"warehouse\".\"analytics\".\"staging_users\"), \n         (select current_date::date),\n         '1 day'\n      ) as datum\n) DQ\nORDER BY 1", "relation_name": "\"warehouse\".\"analytics\".\"dim_date\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-17T23:13:51.323309Z", "completed_at": "2023-12-17T23:13:51.334722Z"}, {"name": "execute", "started_at": "2023-12-17T23:13:51.337647Z", "completed_at": "2023-12-17T23:13:51.444593Z"}], "thread_id": "Thread-1", "execution_time": 0.12895631790161133, "adapter_response": {"_message": "SELECT 2", "code": "SELECT", "rows_affected": 2}, "message": "SELECT 2", "failures": null, "unique_id": "model.dbt_project.dim_gender", "compiled": true, "compiled_code": "with unique_gender as (\n    select\n        distinct gender\n    from \"warehouse\".\"analytics\".\"staging_users\"\n)\n\nselect \n    row_number() over(order by gender) as gender_id\n    ,gender\nfrom unique_gender", "relation_name": "\"warehouse\".\"analytics\".\"dim_gender\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-17T23:13:51.461688Z", "completed_at": "2023-12-17T23:13:51.471530Z"}, {"name": "execute", "started_at": "2023-12-17T23:13:51.474296Z", "completed_at": "2023-12-17T23:13:51.578389Z"}], "thread_id": "Thread-1", "execution_time": 0.12284016609191895, "adapter_response": {"_message": "SELECT 21", "code": "SELECT", "rows_affected": 21}, "message": "SELECT 21", "failures": null, "unique_id": "model.dbt_project.dim_nationality", "compiled": true, "compiled_code": "with unique_nationality as (\n    select\n        distinct nationality\n    from \"warehouse\".\"analytics\".\"staging_users\"\n)\n\nselect \n    row_number() over(order by nationality) as nationality_id\n    ,nationality\nfrom unique_nationality", "relation_name": "\"warehouse\".\"analytics\".\"dim_nationality\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-17T23:13:51.599405Z", "completed_at": "2023-12-17T23:13:51.611044Z"}, {"name": "execute", "started_at": "2023-12-17T23:13:51.614350Z", "completed_at": "2023-12-17T23:13:51.774944Z"}], "thread_id": "Thread-1", "execution_time": 0.18626856803894043, "adapter_response": {"_message": "SELECT 2208", "code": "SELECT", "rows_affected": 2208}, "message": "SELECT 2208", "failures": null, "unique_id": "model.dbt_project.fact_users", "compiled": true, "compiled_code": "select \n    user_id::varchar(255) as user_id\n    ,first_name::varchar(255) as first_name\n    ,last_name::varchar(255) as last_name\n    ,seed::varchar(255) as seed\n    ,dob::date as dob\n    ,sg.gender_id::int as gender_id\n    ,sn.nationality_id::int as nationality_id\n    ,ru.reg_date::date as reg_date\nfrom \"warehouse\".\"analytics\".\"staging_users\" ru\ninner join \"warehouse\".\"analytics\".\"dim_date\" dd\non ru.dob::date = dd.date::date \ninner join \"warehouse\".\"analytics\".\"dim_gender\" sg\non ru.gender = sg.gender\ninner join \"warehouse\".\"analytics\".\"dim_nationality\" sn\non ru.nationality = sn.nationality", "relation_name": "\"warehouse\".\"analytics\".\"fact_users\""}], "elapsed_time": 1.7462410926818848, "args": {"indirect_selection": "eager", "log_path": "/opt/airflow/dbt_project/logs", "partial_parse_file_diff": true, "warn_error_options": {"include": [], "exclude": []}, "vars": {}, "exclude": [], "introspect": true, "print": true, "macro_debugging": false, "favor_state": false, "send_anonymous_usage_stats": true, "include_saved_query": false, "show": false, "populate_cache": true, "which": "build", "enable_legacy_logger": false, "log_file_max_bytes": 10485760, "invocation_command": "dbt build --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profile", "log_format_file": "debug", "strict_mode": false, "write_json": true, "use_colors": true, "log_level": "info", "project_dir": "/opt/airflow/dbt_project", "profiles_dir": "/opt/airflow/dbt_profile", "defer": false, "cache_selected_only": false, "log_level_file": "debug", "show_resource_report": false, "use_colors_file": true, "version_check": true, "partial_parse": true, "log_format": "default", "select": [], "quiet": false, "resource_types": [], "static_parser": true, "printer_width": 80}}