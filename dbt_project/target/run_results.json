{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.4", "generated_at": "2023-12-17T21:17:34.342516Z", "invocation_id": "8e770dc2-409b-415d-ade8-31f3de7057de", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-17T21:17:32.758694Z", "completed_at": "2023-12-17T21:17:32.778848Z"}, {"name": "execute", "started_at": "2023-12-17T21:17:32.782140Z", "completed_at": "2023-12-17T21:17:33.125631Z"}], "thread_id": "Thread-1", "execution_time": 0.3784956932067871, "adapter_response": {"_message": "SELECT 1123", "code": "SELECT", "rows_affected": 1123}, "message": "SELECT 1123", "failures": null, "unique_id": "model.dbt_project.staging_users", "compiled": true, "compiled_code": "SELECT\n    user_id::VARCHAR(255),\n    name -> 'first' AS first_name,\n    (name ->> 'last')::VARCHAR(255) AS last_name,\n    seed::VARCHAR(255) AS seed,\n    (dob ->> 'date')::VARCHAR(10) AS dob,\n    (dob ->> 'age')::INT AS age,\n    nat::VARCHAR(100) AS nationality,\n    gender::VARCHAR(5) AS gender\nFROM \"warehouse\".\"raw\".\"users\"", "relation_name": "\"warehouse\".\"analytics\".\"staging_users\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-17T21:17:33.153842Z", "completed_at": "2023-12-17T21:17:33.168030Z"}, {"name": "execute", "started_at": "2023-12-17T21:17:33.172369Z", "completed_at": "2023-12-17T21:17:33.724424Z"}], "thread_id": "Thread-1", "execution_time": 0.5804080963134766, "adapter_response": {"_message": "SELECT 20730", "code": "SELECT", "rows_affected": 20730}, "message": "SELECT 20730", "failures": null, "unique_id": "model.dbt_project.dim_date", "compiled": true, "compiled_code": "SELECT TO_CHAR(datum, 'yyyymmdd')::INT AS dim_date_id,\n       datum AS date,\n       TO_CHAR(datum, 'TMDay') AS day_name,\n       EXTRACT(ISODOW FROM datum) AS day_of_week,\n       EXTRACT(DAY FROM datum) AS day_of_month,\n       EXTRACT(DOY FROM datum) AS day_of_year,\n       TO_CHAR(datum, 'W')::INT AS week_of_month,\n       EXTRACT(WEEK FROM datum) AS week_of_year,\n       EXTRACT(ISOYEAR FROM datum) || TO_CHAR(datum, '\"-W\"IW-') || EXTRACT(ISODOW FROM datum) AS week_of_year_iso,\n       EXTRACT(MONTH FROM datum) AS month_actual,\n       TO_CHAR(datum, 'TMMonth') AS month_name,\n       TO_CHAR(datum, 'Mon') AS month_name_abbreviated\nFROM (\n   select * \n      from \n      generate_series(\n         (select min(dob)::date from \"warehouse\".\"analytics\".\"staging_users\"), \n         (select max(dob)::date from \"warehouse\".\"analytics\".\"staging_users\"),\n         '1 day'\n      ) as datum\n) DQ\nORDER BY 1", "relation_name": "\"warehouse\".\"analytics\".\"dim_date\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-17T21:17:33.744636Z", "completed_at": "2023-12-17T21:17:33.754199Z"}, {"name": "execute", "started_at": "2023-12-17T21:17:33.758110Z", "completed_at": "2023-12-17T21:17:33.877801Z"}], "thread_id": "Thread-1", "execution_time": 0.14214611053466797, "adapter_response": {"_message": "SELECT 2", "code": "SELECT", "rows_affected": 2}, "message": "SELECT 2", "failures": null, "unique_id": "model.dbt_project.dim_gender", "compiled": true, "compiled_code": "with unique_gender as (\n    select\n        distinct gender\n    from \"warehouse\".\"analytics\".\"staging_users\"\n)\n\nselect \n    row_number() over(order by gender) as gender_id\n    ,gender\nfrom unique_gender", "relation_name": "\"warehouse\".\"analytics\".\"dim_gender\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-17T21:17:33.898537Z", "completed_at": "2023-12-17T21:17:33.908323Z"}, {"name": "execute", "started_at": "2023-12-17T21:17:33.911834Z", "completed_at": "2023-12-17T21:17:34.062232Z"}], "thread_id": "Thread-1", "execution_time": 0.17311763763427734, "adapter_response": {"_message": "SELECT 21", "code": "SELECT", "rows_affected": 21}, "message": "SELECT 21", "failures": null, "unique_id": "model.dbt_project.dim_nationality", "compiled": true, "compiled_code": "with unique_nationality as (\n    select\n        distinct nationality\n    from \"warehouse\".\"analytics\".\"staging_users\"\n)\n\nselect \n    row_number() over(order by nationality) as nationality_id\n    ,nationality\nfrom unique_nationality", "relation_name": "\"warehouse\".\"analytics\".\"dim_nationality\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-17T21:17:34.084520Z", "completed_at": "2023-12-17T21:17:34.095483Z"}, {"name": "execute", "started_at": "2023-12-17T21:17:34.099216Z", "completed_at": "2023-12-17T21:17:34.275232Z"}], "thread_id": "Thread-1", "execution_time": 0.20355892181396484, "adapter_response": {"_message": "SELECT 1123", "code": "SELECT", "rows_affected": 1123}, "message": "SELECT 1123", "failures": null, "unique_id": "model.dbt_project.fact_users", "compiled": true, "compiled_code": "select \n    user_id\n    ,first_name\n    ,last_name\n    ,seed as seed\n    ,dob\n    ,dd.dim_date_id\n    ,sg.gender_id\n    ,sn.nationality_id\nfrom \"warehouse\".\"analytics\".\"staging_users\" ru\ninner join \"warehouse\".\"analytics\".\"dim_date\" dd\non ru.dob::date = dd.date::date \ninner join \"warehouse\".\"analytics\".\"dim_gender\" sg\non ru.gender = sg.gender\ninner join \"warehouse\".\"analytics\".\"dim_nationality\" sn\non ru.nationality = sn.nationality", "relation_name": "\"warehouse\".\"analytics\".\"fact_users\""}], "elapsed_time": 1.7901310920715332, "args": {"include_saved_query": false, "indirect_selection": "eager", "which": "build", "vars": {}, "defer": false, "partial_parse_file_diff": true, "version_check": true, "project_dir": "/opt/airflow/dbt_project", "partial_parse": true, "select": [], "quiet": false, "write_json": true, "invocation_command": "dbt build --project-dir /opt/airflow/dbt_project --profiles-dir /opt/airflow/dbt_profile", "favor_state": false, "log_format": "default", "send_anonymous_usage_stats": true, "log_level_file": "debug", "use_colors": true, "static_parser": true, "macro_debugging": false, "warn_error_options": {"include": [], "exclude": []}, "log_path": "/opt/airflow/dbt_project/logs", "introspect": true, "strict_mode": false, "log_format_file": "debug", "cache_selected_only": false, "populate_cache": true, "resource_types": [], "use_colors_file": true, "show": false, "log_file_max_bytes": 10485760, "profiles_dir": "/opt/airflow/dbt_profile", "enable_legacy_logger": false, "show_resource_report": false, "exclude": [], "log_level": "info", "printer_width": 80, "print": true}}